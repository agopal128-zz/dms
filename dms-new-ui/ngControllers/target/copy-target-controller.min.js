"use strict";define(["angularAMD","confirmationModalService","targetService"],function(e){e.controller("copyTargetController",["confirmationModalService","targetService","notificationService","configService","kpiTargets","targetParams","$uibModalInstance",function(e,r,t,i,o,s,n){var a=this;a.kpiTargets=o,a.scorecardId=s.scorecardId,a.fromYear=s.fromYear,a.toYear=s.toYear,a.selectedTargets=[],a.isCopyVisible=!1,a.isCopying=!1;var c=i.getUIResources("Target"),l=function(){var e={targets:a.selectedTargets,calendarYearId:a.toYear.id};r.copyTargets(a.scorecardId,e).then(function(e){t.notify(c.CopiedSuccessfully,{type:"success"}).then(function(){var e={calendarYearId:a.toYear.id};a.isCopying=!1,n.close(e)})},function(e){a.isCopying=!1,t.notify(e.errors.join("<br/>"),{autoClose:!1,type:"danger"})})};a.setSelectedTargets=function(e){e.isSelected=!0,a.selectedTargets.push(e),a.isCopyVisible=!0},a.updateSelectedTargets=function(e){if(e.isSelected)a.selectedTargets.push(e);else{var r=a.selectedTargets.indexOf(e);a.selectedTargets.splice(r,1)}},a.copy=function(){if(a.errors=[],a.selectedTargets.length||a.errors.push(c.RequiredMetricSelection),a.errors.length)t.notify(a.errors.join("<br/>"),{autoClose:!1,type:"danger"});else{var r=e.openConfirmationModal("md",c.CopyTargetConfirmationMsg);r.result.then(function(){a.isCopying=!0,l()},function(){a.isCopying=!1})}},a.cancel=function(){t.close(),n.dismiss("cancel")}}])});