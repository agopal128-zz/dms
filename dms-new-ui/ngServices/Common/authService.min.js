"use strict";define(["angularAMD"],function(e){e.service("authService",["sessionStorageService","configService","$window","$http","$q","$httpParamSerializerJQLike",function(e,t,n,o,i,r){t.getApiBaseUrl()+"Authorization/";this.isAuthorized=function(){return null!==e.get(AppConfig.AuthTokenKey)&&void 0!==e.get(AppConfig.AuthTokenKey)&&""!==e.get(AppConfig.AuthTokenKey)},this.isAuthorizedAndRedirect=function(){if(null===e.get(AppConfig.AuthTokenKey)||void 0===e.get(AppConfig.AuthTokenKey)||""===e.get(AppConfig.AuthTokenKey)){var o=t.getAppUrl();n.location.href=o+"Login"}return!0},this.setAuthHeader=function(t){var n=e.get(AppConfig.AuthTokenKey);n&&(t.headers.Authorization="Bearer "+n)},this.login=function(n,u){var s={grant_type:"password",username:n,password:u},a=i.defer(),p=t.getApiBaseUrl().replace("/api","")+"token";return o({url:p,method:"POST",data:r(s),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(t){if(t){var n=[];n=t.role.split(",");var o={user:t.user,fullName:t.fullname,roles:n};e.set("userData",JSON.stringify(o)),e.set(AppConfig.AuthTokenKey,t.access_token),a.resolve(o.roles)}}).error(function(e,t){a.reject(e)}),a.promise},this.logout=function(){e.remove(AppConfig.AuthTokenKey),e.remove("userData")}}])});