"use strict";define(["angularAMD"],function(e){e.service("scorecardService",["configService","$http","$log","$q",function(e,r,t,o){var c=e.getApiBaseUrl()+"ScorecardAdmin/",n=this;n.hierarchyDropdownDto={kpiOwnerScorecards:[],teamMemberScorecards:[],rootScorecards:[],scorecardExists:!1},this.addOrRemoveFromExistingList=function(e,r){var t=r.map(function(e){return{id:e.id,name:e.namePrefix?e.namePrefix+" - "+e.name:e.name,scorecardName:e.name,topScorecardId:e.topScorecardId,parentScorecardId:e.parentScorecardId}});t.forEach(function(r){e.pushIfNotExist(r,function(e){return r.id===e.id})}),e.forEach(function(r){t.inArray(function(e){return r.id===e.id})||e.splice(e.indexOf(r),1)})},this.updateExistingDropDownDto=function(e,r){e.scorecardExists=r.scorecardExists,n.addOrRemoveFromExistingList(e.kpiOwnerScorecards,r.kpiOwnerScorecards),n.addOrRemoveFromExistingList(e.teamMemberScorecards,r.teamMemberScorecards),n.addOrRemoveFromExistingList(e.rootScorecards,r.rootScorecards)},this.getScorecard=function(e){var t=o.defer(),n=c+e;return r.get(n).success(function(e){t.resolve(e.data)}).error(function(e,r){t.reject(e)}),t.promise},this.getScorecardTemplateData=function(e){var t=o.defer(),n=c+"GetScoreCardTemplateData/"+e;return r.get(n).success(function(e){t.resolve(e.data)}).error(function(e,r){t.reject(e)}),t.promise},this.getScorecardHierarchyData=function(e,t){var n=o.defer(),s=c+"GetScorecardHierarchy/"+e+"/"+t;return r.get(s).success(function(e){n.resolve(e.data)}).error(function(e,r){n.reject(e)}),n.promise},this.getHierarchyDropdownList=function(){var e=o.defer(),t=c+"GetHierarchyDropdownList";return r.get(t).success(function(r){n.updateExistingDropDownDto(n.hierarchyDropdownDto,r.data),e.resolve(n.hierarchyDropdownDto)}).error(function(r,t){e.reject(r)}),e.promise},this.getMultipleScorecardHierarchyData=function(){var e=o.defer(),t=c+"GetMultipleScorecardHierarchy";return r.get(t).success(function(r){e.resolve(r.data)}).error(function(r,t){e.reject(r)}),e.promise},this.getScorecardList=function(){var e=o.defer(),t=c+"GetScorecards";return r.get(t).success(function(r){e.resolve(r.data)}).error(function(r,t){e.reject(r)}),e.promise},this.addScorecard=function(e){var t=o.defer(),n=c;return r.post(n,e).success(function(e){t.resolve(e)}).error(function(e,r){t.reject(e)}),t.promise},this.updateScorecard=function(e){var t=o.defer(),n=c;return r.put(n,e).success(function(e){t.resolve(e)}).error(function(e,r){t.reject(e)}),t.promise},this.changeSortOrder=function(e){var t=o.defer(),n=c+"ChangeSortOrder";return r.put(n,e).success(function(e){t.resolve(e)}).error(function(e,r){t.reject(e)}),t.promise},this.getFacilities=function(e){var t=o.defer(),n=c+"GetFacilities/"+e;return r.get(n,e).success(function(e){t.resolve(e.data)}).error(function(e,r){t.reject(e)}),t.promise},this.getDivisions=function(e){var t=o.defer(),n=c+"GetDivisions/"+e;return r.get(n).success(function(e){t.resolve(e.data)}).error(function(e,r){t.reject(e)}),t.promise},this.loadADUsers=function(t){var c=o.defer(),n=e.getApiBaseUrl()+"User/GetADUsersWithLastNameOrAccountName?name="+t;return r.get(n).success(function(e){c.resolve(e.data)}).error(function(e,r){c.reject(e)}),c.promise},this.loadNDMSUsers=function(t){var c=o.defer(),n=e.getApiBaseUrl()+"User/GetNDMSUsersWithLastName/"+t;return r.get(n).success(function(e){c.resolve(e.data)}).error(function(e,r){c.reject(e)}),c.promise},this.addCounterMeasure=function(t){var c=o.defer(),n=e.getApiBaseUrl()+"CounterMeasure/AddCounterMeasure";return r.post(n,t).success(function(e){c.resolve(e.data)}).error(function(e,r){c.reject(e)}),c.promise},this.updateCounterMeasure=function(t){var c=o.defer(),n=e.getApiBaseUrl()+"CounterMeasure/EditCounterMeasure";return r.put(n,t).success(function(e){c.resolve(e)}).error(function(e,r){c.reject(e)}),c.promise},this.getCounterMeasureById=function(t){var c=o.defer(),n=e.getApiBaseUrl()+"CounterMeasure/GetCounterMeasure/"+t;return r.get(n).success(function(e){c.resolve(e)}).error(function(e,r){c.reject(e)}),c.promise},this.getCounterMeasurePriority=function(){var t=o.defer(),c=e.getApiBaseUrl()+"CounterMeasure/GetAllCounterMeasurePriority";return r.get(c).success(function(e){t.resolve(e.data)}).error(function(e,r){t.reject(e)}),t.promise},this.getScorecardAndTargetStatus=function(){var t=o.defer(),c=e.getApiBaseUrl()+"User/GetScorecardIdAndTargetStatus";return r.get(c).success(function(e){t.resolve(e.data)}).error(function(e,r){if(404===r){var o="There is no scorecard available for current user!";t.reject(o)}else t.reject(e)}),t.promise}}])});